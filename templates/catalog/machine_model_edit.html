{% extends "layouts/two_column.html" %}
{% load core_extras %}
{% block title %}Edit Model: {{ object.name }} Â· {{ block.super }}{% endblock %}
{% block breadcrumbs %}
  <nav class="breadcrumbs breadcrumbs--responsive">
    <a href="{% url 'maintainer-machine-list' %}" class="breadcrumbs__link">Machines</a>
    <span>/</span>
    {% if machine_instance %}
      <a href="{% url 'maintainer-machine-detail' machine_instance.slug %}"
         class="breadcrumbs__link">{{ machine_instance.display_name }}</a>
      <span>/</span>
      <a href="{% url 'machine-edit' machine_instance.slug %}"
         class="breadcrumbs__link">Edit</a>
      <span>/</span>
    {% endif %}
    <span class="breadcrumbs__current">Model</span>
  </nav>
{% endblock %}
{% block sidebar %}
  {% sidebar %}
  {% include "components/history_link.html" with history_url=object.get_admin_history_url %}
  {% sidebar_section label="Edit Model" %}
  <div class="sidebar__title">{{ object.name }}</div>
{% endsidebar_section %}
{% if instances %}
  {% sidebar_section label="Machines" %}
  <ul class="sidebar__list">
    {% for instance in instances %}
      <li>
        <a href="{% url 'maintainer-machine-detail' instance.slug %}">{{ instance.display_name }}</a>
      </li>
    {% endfor %}
  </ul>
{% endsidebar_section %}
{% endif %}
{% endsidebar %}
{% endblock %}
{% block main %}
  <div class="card card--padded">
    <form method="post" class="form-main">
      {% csrf_token %}
      {% form_non_field_errors form %}
      {% for fieldset_title, field_names in form.fieldsets %}
        <fieldset class="form-section">
          <legend>{{ fieldset_title }}</legend>
          {% for field_name in field_names %}
            {% with field=form|getfield:field_name %}
              {% form_field field %}
            {% endwith %}
          {% endfor %}
        </fieldset>
      {% endfor %}
      <div class="form-actions">
        <a href="{% url 'maintainer-machine-list' %}" class="btn btn--secondary">
          <i class="fa-solid fa-circle-xmark meta"></i>
          Cancel
        </a>
        <button type="submit" class="btn btn--log">
          <i class="fa-solid fa-floppy-disk meta"></i>
          Save Changes
        </button>
      </div>
    </form>
  </div>
{% endblock %}
