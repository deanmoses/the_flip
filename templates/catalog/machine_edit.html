{% extends "base.html" %}
{% load core_extras %}
{% block title %}Edit {{ object.display_name }} · {{ block.super }}{% endblock %}
{% block content %}
  <nav class="breadcrumb breadcrumb--with-actions">
    <div class="breadcrumb__trail">
      <a href="{% url 'maintainer-machine-list' %}">Machines</a>
      <span>›</span>
      <a href="{% url 'maintainer-machine-detail' object.slug %}">{{ object.display_name }}</a>
      <span>›</span>
      <strong>Edit</strong>
    </div>

    <div class="breadcrumb__actions">
      <a class="btn btn-secondary" href="{% url 'machine-model-edit' object.model.slug %}">Edit Model Info</a>
    </div>
  </nav>

  <form method="post" class="form-container">
    {% csrf_token %}
    {{ form.non_field_errors }}

    {% for fieldset_title, field_names in form.fieldsets %}
      <fieldset class="form-section">
        <legend>{{ fieldset_title }}</legend>
        {% for field_name in field_names %}
          {% with field=form|getfield:field_name %}
            <div class="form-field">
              {{ field.label_tag }}
              {{ field }}
              {% if field.help_text %}<small class="help-text">{{ field.help_text }}</small>{% endif %}
              {% for error in field.errors %}
                <div class="field-error">{{ error }}</div>
              {% endfor %}
            </div>
          {% endwith %}
        {% endfor %}
      </fieldset>
    {% endfor %}

    <div class="form-actions">
      <button type="submit" class="btn btn-primary">Save Changes</button>
    </div>
  </form>
{% endblock %}
