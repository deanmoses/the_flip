{% load core_extras %}
<div class="machine-card"
     data-search-text="{{ machine.display_name }} {{ machine.model.year }} {{ machine.model.manufacturer }} {{ machine.get_operational_status_display }}{% if machine.location %} {{ machine.location.name }}{% endif %}{% if machine.latest_open_report %} {{ machine.latest_open_report.0.description }}{% endif %}">
  <a href="{% url 'maintainer-machine-detail' machine.slug %}"
     class="machine-card__inner">
    <div class="machine-card__header">
      <div class="machine-card__title">{{ machine.display_name }}</div>
      <span class="pill {% if machine.operational_status == 'good' %}pill--status-good{% elif machine.operational_status == 'fixing' %}pill--status-fixing{% elif machine.operational_status == 'broken' %}pill--status-broken{% else %}pill--neutral{% endif %}">
        {% if machine.operational_status == 'fixing' %}
          <i class="fa-solid fa-wrench meta"></i>
        {% elif machine.operational_status == 'good' %}
          <i class="fa-solid fa-check meta"></i>
        {% elif machine.operational_status == 'broken' %}
          <i class="fa-solid fa-circle-xmark meta"></i>
        {% else %}
          <i class="fa-solid fa-circle-question meta"></i>
        {% endif %}
        {{ machine.get_operational_status_display }}
      </span>
    </div>
    <div class="machine-card__meta">
      {% if machine.model.manufacturer %}{{ machine.model.manufacturer }}{% endif %}
      {% if machine.model.manufacturer and machine.model.year %}·{% endif %}
      {% if machine.model.year %}{{ machine.model.year }}{% endif %}
      {% if machine.location and machine.location.slug != "floor" %}
        · <i class="fa-solid fa-location-dot meta"></i> {{ machine.location.name }}
      {% endif %}
    </div>
    {% if machine.latest_open_report %}
      <div class="machine-card__alert">
        <i class="fa-solid fa-bug text-problem"></i>
        <span>{{ machine.latest_open_report.0|problem_report_summary }}</span>
      </div>
    {% endif %}
  </a>
</div>
