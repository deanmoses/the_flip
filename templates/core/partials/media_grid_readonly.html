{# Read-only media thumbnails for list views #}
{# Usage: {% include "core/partials/media_grid_readonly.html" with media_items=entry.media.all detail_url=url model_name="LogEntryMedia" %} #}
{# Requires: Include video_transcode_poll.js in page scripts for auto-updates #}
{% load core_extras %}
{% if media_items %}
  <a href="{{ detail_url }}" class="timeline__media-link">
    <div class="media-grid">
      {% for media in media_items %}
        <div class="media-grid__item">
          {% if media.media_type == 'video' %}
            {% if media.transcode_status == 'ready' and media.poster_file %}
              <img src="{{ media.poster_file.url }}" alt="Video poster">
            {% elif media.transcode_status == 'processing' or media.transcode_status == 'pending' %}
              <div class="media-grid__status"
                   data-media-poll-id="{{ media.id }}"
                   data-media-poll-model="{{ model_name|default:'LogEntryMedia' }}">Processing video...</div>
            {% else %}
              <div class="media-grid__status media-grid__status--error">Video processing failed.</div>
            {% endif %}
          {% else %}
            {% if media.thumbnail_file %}
              <img src="{{ media.thumbnail_file.url }}" alt="Photo">
            {% else %}
              <img src="{{ media.file.url }}" alt="Photo">
            {% endif %}
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </a>
{% endif %}
