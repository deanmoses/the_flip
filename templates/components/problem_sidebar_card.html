{% load core_extras %}
{% if editable %}
  <div class="sidebar-card-wrapper" id="problem-card-wrapper">
    <button type="button"
            class="sidebar-card__edit"
            id="problem-edit-btn"
            aria-label="{% if problem_report %}Change problem report{% else %}Link to problem report{% endif %}"
            title="{% if problem_report %}Change problem report{% else %}Link to problem report{% endif %}">
      <i class="fa-solid fa-pencil"></i>
    </button>
  {% endif %}
  {% if problem_report %}
    <a href="{% url 'problem-report-detail' problem_report.pk %}"
       class="sidebar-card sidebar-card--problem"
       id="problem-card-link">
      <div class="sidebar-card__header sidebar-card__header--problem">
        <i class="fa-solid fa-bug"></i>
        <span>#{{ problem_report.pk }}</span>
      </div>
      <p class="sidebar-card__text">{{ problem_report|problem_report_summary }}</p>
      <p class="sidebar-card__meta">
        {% if problem_report.reporter_display %}{{ problem_report.reporter_display }} Â·{% endif %}
        {{ problem_report.created_at|smart_date }}
      </p>
    </a>
  {% else %}
    <div class="sidebar-card sidebar-card--neutral" id="problem-card-link">
      <div class="sidebar-card__header" style="color: var(--color-gray-500);">
        <i class="fa-solid fa-bug"></i>
        <span>None</span>
      </div>
      <p class="sidebar-card__meta">Not linked to a problem report</p>
    </div>
  {% endif %}
  {% if editable %}
    <div class="sidebar-card-edit-dropdown hidden" id="problem-dropdown">
      <div class="sidebar-card-edit-dropdown__search">
        <input type="text"
               id="problem-search"
               class="form-input form-input--sm"
               placeholder="Search problem reports..."
               autocomplete="off">
      </div>
      <div id="problem-dropdown-list"></div>
    </div>
  </div>
{% endif %}
