{% extends "layouts/two_column.html" %}
{% load core_extras %}
{% block title %}Change Password Â· {{ block.super }}{% endblock %}
{% block breadcrumbs %}
  <a href="{% url 'profile' %}">Profile</a>
  <span>Change Password</span>
{% endblock %}
{% block mobile_actions %}
  <a href="{% url 'profile' %}" class="btn btn--secondary">
    <i class="fa-solid fa-arrow-left meta"></i>
    Back to Profile
  </a>
{% endblock %}
{% block sidebar %}
  {% sidebar_section label="Change Password" %}
  <div class="sidebar__title">{{ user|display_name_with_username }}</div>
{% endsidebar_section %}
{% sidebar_section %}
<a href="{% url 'profile' %}" class="btn btn--secondary btn--full">
  <i class="fa-solid fa-arrow-left meta"></i>
  Back to Profile
</a>
{% endsidebar_section %}
{% endblock %}
{% block main %}
  <div class="card card--padded">
    <form method="post" class="form-main">
      {% csrf_token %}
      {% form_non_field_errors form %}
      <div class="form-field">
        <label for="id_old_password" class="form-label">Current password</label>
        <input type="password"
               name="old_password"
               id="id_old_password"
               class="form-input"
               required
               autocomplete="current-password">
        {% field_errors form.old_password %}
      </div>
      <div class="form-field">
        <label for="id_new_password1" class="form-label">New password</label>
        <input type="password"
               name="new_password1"
               id="id_new_password1"
               class="form-input"
               required
               autocomplete="new-password">
        <label class="checkbox-label space-above-sm">
          <input type="checkbox" id="show-password" class="checkbox">
          <span>Show password</span>
        </label>
        {% field_errors form.new_password1 %}
      </div>
      <div class="form-actions">
        <a href="{% url 'profile' %}" class="btn btn--secondary">
          <i class="fa-solid fa-circle-xmark meta"></i>
          Cancel
        </a>
        <button type="submit" class="btn btn--primary">
          <i class="fa-solid fa-key meta"></i>
          Change Password
        </button>
      </div>
    </form>
  </div>
  <script>
    (function() {
      const passwordInput = document.getElementById('id_new_password1');
      const showPasswordCheckbox = document.getElementById('show-password');
      showPasswordCheckbox.addEventListener('change', function() {
        passwordInput.type = this.checked ? 'text' : 'password';
      });
    })();
  </script>
{% endblock %}
