{% load core_extras %}
<li>
  <a href="{% url 'log-detail' entry.pk %}" class="log-entry-link">
    <div class="log-entry-meta">
      <strong>{{ entry.work_date|smart_date }}</strong>
      {% if entry.maintainers.all %}
        <span>by {{ entry.maintainers.all|join:", " }}:</span>
      {% elif entry.maintainer_names %}
        <span>by {{ entry.maintainer_names }}:</span>
      {% else %}
        <span>:</span>
      {% endif %}
    </div>
    <div class="log-entry-text markdown-content">{{ entry.text|render_markdown }}</div>
    {% if entry.media.all %}
      <div class="log-entry-media">
        {% for media in entry.media.all %}
          {% if media.media_type == 'video' %}
            {% if media.transcode_status == 'ready' and media.poster_file %}
              <img src="{{ media.poster_file.url }}"
                   alt="Video poster for {{ machine.display_name }}"
                   width="200">
            {% elif media.transcode_status == 'processing' or media.transcode_status == 'pending' %}
              <span class="media-status">Video processingâ€¦</span>
            {% else %}
              <span class="media-status error">Video failed</span>
            {% endif %}
          {% else %}
            <img src="{{ media.file.url }}"
                 alt="Photo for {{ machine.display_name }}"
                 width="200">
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </a>
</li>
