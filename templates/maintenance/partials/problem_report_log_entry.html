{% load core_extras %}
<article class="card card--padded card--log js-clickable-card"
         data-url="{% url 'log-detail' entry.pk %}"
         tabindex="0"
         role="button"
         aria-label="View log entry #{{ entry.pk }}">
  <div class="flex items-center justify-between stack-tight">
    <div class="flex items-center stack-tight">
      <i class="fa-solid fa-screwdriver-wrench text-log"></i>
    </div>
    <div class="log-entry-meta">{{ entry|log_entry_meta }}</div>
  </div>
  <div class="space-above-sm">
    <div class="markdown-content markdown-content--compact">{{ entry.text|render_markdown }}</div>
    {% if entry.media.all %}
      <div class="flex flex-wrap stack-tight space-above-sm">
        {% for media in entry.media.all %}
          {% if media.media_type == 'video' %}
            {% if media.transcode_status == 'ready' and media.poster_file %}
              <img src="{{ media.poster_file.url }}" alt="Video poster" width="160">
            {% elif media.transcode_status == 'processing' or media.transcode_status == 'pending' %}
              <span class="text-muted body-small">Video processingâ€¦</span>
            {% else %}
              <span class="text-problem body-small">Video failed</span>
            {% endif %}
          {% else %}
            {% if media.thumbnail_file %}
              <img src="{{ media.thumbnail_file.url }}" alt="Photo" width="160">
            {% else %}
              <img src="{{ media.file.url }}" alt="Photo" width="160">
            {% endif %}
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </div>
</article>
