{% extends "base.html" %}
{% load static core_extras %}
{% block title %}Problem Reports · {{ block.super }}{% endblock %}
{% block content %}
  <h2>Problem Reports</h2>
  <div class="list-header">
    <div class="list-header__left">
      <form method="get" action="">
        <div class="form-field">{{ search_form.q }}</div>
      </form>
    </div>
    <div class="list-header__right">
      <a href="{% url 'problem-report-create' %}" class="btn btn-primary">+ New Problem Report</a>
    </div>
  </div>
  <section>
    <div id="log-container"
         data-fetch-url="{% url 'problem-report-list-entries' %}">
      {% if reports %}
        <ul class="list machine-list problem-report-list" id="log-list">
          {% for report in reports %}
            {% include "maintenance/partials/problem_report_list_entry.html" with report=report %}
          {% endfor %}
        </ul>
        <div id="log-pagination"
             data-next-page="{% if page_obj.has_next %}{{ page_obj.next_page_number }}{% else %}0{% endif %}"></div>
      {% else %}
        <p>
          {% if search_form.q.value %}
            No problem reports match your search.
          {% else %}
            No problem reports yet.
          {% endif %}
        </p>
      {% endif %}
    </div>
    <div id="log-loading" class="hidden">Loading…</div>
    <div id="log-sentinel"></div>
  </section>
{% endblock %}
{% block extra_scripts %}
  <script src="{% static 'core/infinite_scroll.js' %}" defer></script>
{% endblock %}
