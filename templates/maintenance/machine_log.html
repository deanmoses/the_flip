{% extends "base.html" %}
{% load static core_extras %}
{% block title %}{{ machine.display_name }} Log · {{ block.super }}{% endblock %}
{% block content %}
  <nav class="breadcrumb breadcrumb--with-actions">
    <div class="breadcrumb__trail">
      <a href="{% url 'maintainer-machine-list' %}">Machines</a>
      <span>›</span>
      <a href="{% url 'maintainer-machine-detail' machine.slug %}">{{ machine.display_name }}</a>
      <span>›</span>
      <strong>Logs</strong>
    </div>

    <div class="breadcrumb__actions">
      <a class="btn btn-primary" href="{% url 'log-create-machine' machine.slug %}">Add Log Entry</a>
    </div>
  </nav>

  <section>
    <div id="log-container" data-fetch-url="{% url 'log-entries' machine.slug %}">
      {% if log_entries %}
        <ul class="list" id="log-list">
          {% for entry in log_entries %}
            {% include "maintenance/partials/log_entry.html" with entry=entry %}
          {% endfor %}
        </ul>
        <div id="log-pagination" data-next-page="{% if page_obj.has_next %}{{ page_obj.next_page_number }}{% else %}0{% endif %}"></div>
      {% else %}
        <p>No log entries yet.</p>
      {% endif %}
    </div>
    <div id="log-loading" class="hidden">Loading…</div>
    <div id="log-sentinel"></div>
  </section>
{% endblock %}

{% block extra_scripts %}
  <script src="{% static 'core/log_infinite.js' %}" defer></script>
{% endblock %}
