{% extends "base.html" %}
{% load core_extras %}
{% block title %}QR Code: {{ machine.display_name }} Â· {{ block.super }}{% endblock %}
{% block content %}
  <!-- BREADCRUMBS -->
  <nav class="breadcrumbs breadcrumbs--responsive no-print">
    <a href="{% url 'maintainer-machine-list' %}" class="breadcrumbs__link">Machines</a>
    <span>/</span>
    <a href="{% url 'maintainer-machine-detail' machine.slug %}"
       class="breadcrumbs__link">{{ machine.display_name }}</a>
    <span>/</span>
    <span class="breadcrumbs__current">QR Code</span>
  </nav>
  <!-- TWO COLUMN LAYOUT -->
  <div class="two-column">
    <!-- MOBILE ACTIONS -->
    <div class="mobile-actions no-print">
      <button type="button"
              class="btn btn--primary btn--full"
              onclick="window.print()">
        <i class="fa-solid fa-print meta"></i>
        Print QR Code
      </button>
    </div>
    <!-- SIDEBAR -->
    <aside class="two-column__sidebar no-print">
      <div class="card card--padded sidebar--sticky">
        <div class="sidebar__section">
          <div class="sidebar__label">QR Code</div>
          <div class="sidebar__title">{{ machine.display_name }}</div>
          <p class="text-muted text-sm space-above-sm">Attach this QR code to the machine so visitors can scan.</p>
        </div>
        <div class="sidebar__section">
          <div class="sidebar__label">URL</div>
          <code class="text-sm"><a href="{{ public_url }}">{{ public_url }}</a></code>
        </div>
        <div class="sidebar__section">
          <button type="button"
                  class="btn btn--primary btn--full"
                  onclick="window.print()">
            <i class="fa-solid fa-print meta"></i>
            Print QR Code
          </button>
        </div>
      </div>
    </aside>
    <!-- MAIN COLUMN -->
    <div class="two-column__main">
      <div class="card card--padded qr-printable">
        <h2>Report Problem</h2>
        <img src="data:image/png;base64,{{ qr_code_data }}"
             alt="QR Code for {{ machine.display_name }}"
             class="qr-image">
        <h2>{{ machine.display_name }}</h2>
      </div>
    </div>
  </div>
{% endblock %}
{% block extra_scripts %}
  <style>
      /* Screen-only styling */
      .qr-printable {
          text-align: center;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: var(--space-4);
      }

      .qr-printable h2 {
          font-size: 1.5rem;
          margin: 0;
      }

      .qr-image {
          display: block;
          width: 300px;
          height: 300px;
          margin: 0 auto;
      }

      /* Print styles */
      @media print {

          header,
          .no-print {
              display: none !important;
          }

          body {
              margin: 0;
              padding: 0;
          }

          main {
              max-width: 100%;
              padding: 2rem;
          }

          .qr-printable {
              position: absolute;
              top: 0;
              left: 0;
              width: 100%;
              height: 100vh;
              margin: 0;
              padding: 2rem;
              background: white;
              border: none;
              box-shadow: none;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
              gap: 0.25rem;
          }

          .qr-printable h2 {
              font-size: 1.5rem;
              margin: 0;
              color: black;
          }

          .qr-image {
              width: 400px;
              height: 400px;
          }
      }
  </style>
{% endblock %}
