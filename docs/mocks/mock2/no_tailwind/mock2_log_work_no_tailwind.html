<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Flip - Log Work (No Tailwind)</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="mock2_reset.css">
    <link rel="stylesheet" href="mock2_styles.css">
    <link rel="stylesheet" href="mock2_theme_switcher.css">
  </head>
  <body>
    <!-- === PERSISTENT SITE HEADER === -->
    <header class="app-header">
      <a href="#">
        <img src="../../../../the_flip/static/core/images/logo_blue.svg"
             alt="The Flip"
             class="brand-logo">
      </a>
      <!-- Desktop nav (md+) -->
      <nav class="nav nav--desktop">
        <a href="#" class="nav-link nav-link--active">Machines</a>
        <a href="#" class="nav-link">Problem Reports</a>
        <a href="#" class="nav-link">Logs</a>
        <!-- Admin Dropdown (superadmin only) -->
        <div class="dropdown">
          <button id="admin-dropdown-toggle-desktop"
                  class="nav-link dropdown__toggle"
                  onclick="toggleAdminMenu('desktop')">
            Admin <i class="fa-solid fa-caret-down meta"></i>
          </button>
          <div id="admin-menu-desktop"
               class="dropdown__menu dropdown__menu--left hidden">
            <a href="#" class="dropdown__item"><i class="fa-solid fa-users-gear space-right-sm"></i> Shared Accounts</a>
            <a href="#" class="dropdown__item"><i class="fa-solid fa-envelope space-right-sm"></i> Invite User</a>
            <a href="#" class="dropdown__item"><i class="fa-solid fa-toolbox space-right-sm"></i> Django Admin</a>
          </div>
        </div>
      </nav>
      <!-- Mobile nav (icon-only) -->
      <nav class="nav nav--icons nav--mobile">
        <a href="#" class="nav-icon nav-icon--active"><i class="fa-solid fa-list"></i></a>
        <a href="#" class="nav-icon"><i class="fa-solid fa-triangle-exclamation"></i></a>
        <a href="#" class="nav-icon"><i class="fa-solid fa-screwdriver-wrench"></i></a>
        <!-- Admin Dropdown (superadmin only) -->
        <div class="dropdown">
          <button id="admin-dropdown-toggle-mobile"
                  class="nav-icon"
                  onclick="toggleAdminMenu('mobile')">
            <i class="fa-solid fa-users"></i>
          </button>
          <div id="admin-menu-mobile" class="dropdown__menu hidden">
            <a href="#" class="dropdown__item"><i class="fa-solid fa-users-gear space-right-sm"></i> Shared Accounts</a>
            <a href="#" class="dropdown__item"><i class="fa-solid fa-envelope space-right-sm"></i> Invite User</a>
            <a href="#" class="dropdown__item"><i class="fa-solid fa-toolbox space-right-sm"></i> Django Admin</a>
          </div>
        </div>
      </nav>
      <!-- User dropdown -->
      <div class="dropdown">
        <div id="account-dropdown-toggle"
             class="avatar"
             onclick="toggleAccountMenu()">PW</div>
        <div id="account-menu"
             class="dropdown__menu dropdown__menu--narrow hidden">
          <p class="body-small text-muted space-below-sm">PinballWizard99</p>
          <a href="#" class="dropdown__item"><i class="fa-solid fa-gear space-right-sm"></i> Account</a>
          <a href="#" class="dropdown__item dropdown__item--danger"><i class="fa-solid fa-right-from-bracket space-right-sm"></i> Logout</a>
        </div>
      </div>
    </header>
    <!-- === MAIN CONTENT === -->
    <main class="main-content">
      <!-- BREADCRUMBS -->
      <nav class="breadcrumbs breadcrumbs--responsive">
        <a href="#" class="breadcrumbs__link">Machines</a>
        <span>/</span>
        <a href="#" class="breadcrumbs__link">The Addams Family</a>
        <span>/</span>
        <a href="#" class="breadcrumbs__link">Problem #47</a>
        <span>/</span>
        <span class="breadcrumbs__current">Log Work</span>
      </nav>
      <!-- TWO COLUMN LAYOUT: Main Form + Sidebar -->
      <form class="two-column">
        <!-- MAIN COLUMN: Primary form fields -->
        <div class="two-column__main form-main">
          <!-- WORK DESCRIPTION -->
          <div class="form-field">
            <label for="description" class="form-label">
              What work was done? <span class="text-problem">*</span>
            </label>
            <textarea id="description"
                      name="description"
                      class="form-input form-textarea"
                      placeholder="Describe the work performed..."
                      required>Replaced the coil on the upper right flipper. It was showing resistance issues. Test played one game, feels snappy now.</textarea>
            <!-- File upload link (GitHub-style) -->
            <div class="form-hint space-above-sm">
              <input type="file"
                     id="file-input"
                     class="hidden"
                     multiple
                     accept="image/*,video/*">
              <a href="#" id="file-upload-link" class="file-upload-link">
                <i class="fa-solid fa-paperclip space-right-xs"></i>Paste, drop, or click to add files
              </a>
            </div>
            <!-- Uploaded files preview (example) -->
            <div class="file-preview-row">
              <div class="file-preview">
                <div class="file-preview__thumb">
                  <i class="fa-solid fa-image text-muted"></i>
                </div>
                <button type="button" class="file-preview__remove">
                  <i class="fa-solid fa-xmark"></i>
                </button>
              </div>
            </div>
          </div>
          <!-- WHEN/WHO (visible on mobile, hidden on desktop) -->
          <div class="form-row-mobile">
            <div class="form-field">
              <label class="sidebar__label">When</label>
              <input type="datetime-local"
                     id="work_date_mobile"
                     name="work_date"
                     class="form-input form-input--sm">
            </div>
            <div class="form-field">
              <label class="sidebar__label">Who</label>
              <input type="text"
                     id="maintainers_mobile"
                     name="maintainers"
                     class="form-input form-input--sm"
                     placeholder="Who did the work?">
            </div>
          </div>
          <!-- FORM ACTIONS -->
          <div class="form-actions">
            <!-- Close problem checkbox -->
            <label class="checkbox-label">
              <input type="checkbox"
                     id="close_problem"
                     name="close_problem"
                     class="checkbox">
              <span>Close the problem report</span>
            </label>
            <!-- Buttons -->
            <a href="#" class="btn btn--secondary">Cancel</a>
            <button type="submit" class="btn btn--log">
              <i class="fa-solid fa-check meta"></i>
              Log It
            </button>
          </div>
        </div>
        <!-- SIDEBAR: Context & Metadata (desktop only) -->
        <aside class="two-column__sidebar">
          <div class="card card--padded sidebar--sticky">
            <!-- MACHINE -->
            <div class="sidebar__section">
              <div class="sidebar__label">Machine</div>
              <div class="sidebar__title">The Addams Family</div>
              <div class="sidebar__subtitle">Bally • 1992</div>
              <div class="flex flex-wrap stack-tight space-above-sm">
                <span class="pill pill--status-fixing">
                  <i class="fa-solid fa-wrench meta"></i>
                  Fixing
                </span>
                <span class="pill pill--neutral">
                  <i class="fa-solid fa-location-dot meta"></i>
                  Workshop
                </span>
              </div>
            </div>
            <!-- LINKED PROBLEM -->
            <div class="sidebar__section">
              <div class="sidebar__label">Problem</div>
              <a href="#" class="linked-problem-card">
                <div class="linked-problem-card__header">
                  <i class="fa-solid fa-bug text-problem"></i>
                  <span class="linked-problem-card__number">#47</span>
                </div>
                <p class="linked-problem-card__text">Top right flipper barely moves when I hit the button. Ball gets stuck.</p>
                <p class="linked-problem-card__meta">Visitor • Yesterday</p>
              </a>
            </div>
            <!-- WHEN -->
            <div class="sidebar__section">
              <div class="sidebar__label">When</div>
              <input type="datetime-local"
                     id="work_date"
                     name="work_date"
                     class="form-input form-input--sm">
            </div>
            <!-- WHO -->
            <div class="sidebar__section">
              <div class="sidebar__label">Who</div>
              <div class="tag-list">
                <span class="tag tag--blue">
                  TechSam
                  <button type="button" class="tag__remove">
                    <i class="fa-solid fa-xmark"></i>
                  </button>
                </span>
              </div>
              <input type="text"
                     id="maintainers"
                     name="maintainers"
                     class="form-input form-input--sm"
                     placeholder="Who did the work?">
            </div>
          </div>
        </aside>
      </form>
    </main>
    <!-- Theme Switcher (for demo only) -->
    <div class="theme-switcher">
      <button data-theme="default"
              class="theme-switcher__btn theme-switcher__btn--active">Light</button>
      <button data-theme="dark3" class="theme-switcher__btn">Dark</button>
    </div>
    <script>
      // Desktop Account Dropdown
      function toggleAccountMenu() {
        const menu = document.getElementById('account-menu');
        menu.classList.toggle('hidden');
        // Close admin menus when opening account menu
        document.getElementById('admin-menu-desktop').classList.add('hidden');
        document.getElementById('admin-menu-mobile').classList.add('hidden');
      }

      // Admin Dropdown
      function toggleAdminMenu(variant) {
        const menu = document.getElementById('admin-menu-' + variant);
        menu.classList.toggle('hidden');
        // Close the other admin menu and account menu
        const otherVariant = variant === 'desktop' ? 'mobile' : 'desktop';
        document.getElementById('admin-menu-' + otherVariant).classList.add('hidden');
        document.getElementById('account-menu').classList.add('hidden');
      }

      // Close menus on outside click
      document.addEventListener('click', function(event) {
        const accountMenu = document.getElementById('account-menu');
        const accountToggle = document.getElementById('account-dropdown-toggle');
        const adminMenuDesktop = document.getElementById('admin-menu-desktop');
        const adminToggleDesktop = document.getElementById('admin-dropdown-toggle-desktop');
        const adminMenuMobile = document.getElementById('admin-menu-mobile');
        const adminToggleMobile = document.getElementById('admin-dropdown-toggle-mobile');

        // Close account menu if clicking outside
        if (accountMenu && accountToggle && !accountMenu.contains(event.target) && !accountToggle.contains(event.target)) {
          accountMenu.classList.add('hidden');
        }

        // Close admin desktop menu if clicking outside
        if (adminMenuDesktop && adminToggleDesktop && !adminMenuDesktop.contains(event.target) && !adminToggleDesktop.contains(event.target)) {
          adminMenuDesktop.classList.add('hidden');
        }

        // Close admin mobile menu if clicking outside
        if (adminMenuMobile && adminToggleMobile && !adminMenuMobile.contains(event.target) && !adminToggleMobile.contains(event.target)) {
          adminMenuMobile.classList.add('hidden');
        }
      });

      // File upload click handler
      document.getElementById('file-upload-link').addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('file-input').click();
      });

      // Theme switching
      (function() {
        const buttons = document.querySelectorAll('.theme-switcher__btn');

        function setTheme(theme) {
          document.body.setAttribute('data-theme', theme);
          buttons.forEach(btn => {
            btn.classList.toggle('theme-switcher__btn--active', btn.dataset.theme === theme);
          });
        }

        buttons.forEach(btn => {
          btn.addEventListener('click', () => setTheme(btn.dataset.theme));
        });

        setTheme('default');
      })();

      // Set current datetime in the work_date field
      (function() {
        const dateInput = document.getElementById('work_date');
        const dateInputMobile = document.getElementById('work_date_mobile');
        if (dateInput) {
          const now = new Date();
          const year = now.getFullYear();
          const month = String(now.getMonth() + 1).padStart(2, '0');
          const day = String(now.getDate()).padStart(2, '0');
          const hours = String(now.getHours()).padStart(2, '0');
          const minutes = String(now.getMinutes()).padStart(2, '0');
          const value = `${year}-${month}-${day}T${hours}:${minutes}`;
          dateInput.value = value;
          if (dateInputMobile) dateInputMobile.value = value;
        }
      })();
    </script>
  </body>
</html>
