# Config file for building and deploying on Railway.app hosting

[build]
builder = "NIXPACKS"
buildCommand = "./build.sh"
# When updating this, also update what's ignored in .github/workflows/ci.yml
watchPatterns = [
  "**",
  "!**/*.md",
  "!docs/**",
  "!.github/**",
  "!.claude/**",
  "!.vscode/**",
  "!.pre-commit-config.yaml",
  "!.env.example",
  "!.env.vscode"
]

[deploy]
# startCommand intentionally omitted - configure per service:
#   - In Railway dashboard for each service, or
#   - Via NIXPACKS_START_CMD environment variable
# Web service should run: gunicorn the_flip.wsgi:application
# Worker service should run: DJANGO_SETTINGS_MODULE=the_flip.settings.prod python manage.py qcluster
# Disable Railway health checks (blank path/null per Railway docs)
healthcheckPath = ""
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
